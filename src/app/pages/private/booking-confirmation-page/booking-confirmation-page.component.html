<section class="max-w-screen-xl w-11/12 md:w-4/6 mx-auto my-15 dark:text-gray-200">

    <!-- Success Message -->
    <div class="text-center mb-10">
        <div class="inline-flex items-center justify-center w-20 h-20 rounded-full bg-green-100 dark:bg-green-900 mb-6">
            <svg class="w-10 h-10 text-green-600 dark:text-green-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
            </svg>
        </div>
        <h1 class="text-2xl md:text-3xl font-bold text-gray-900 dark:text-white mb-2">
            Reservation confirmee !
        </h1>
        <p class="text-gray-600 dark:text-gray-400">
            Votre reservation a ete enregistree avec succes.
        </p>
    </div>

    <!-- Review Form -->
    <div class="max-w-xl mx-auto bg-white dark:bg-gray-800 rounded-lg shadow-md p-6 md:p-8">
        <h2 class="text-xl font-semibold text-gray-900 dark:text-white mb-6 text-center">
            Donnez-nous votre avis
        </h2>

        @if(serverError()) {
            <div class="bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mb-6">
                {{serverError()}}
            </div>
        }

        <form [formGroup]="reviewForm" (ngSubmit)="submitReview()">

            <!-- Star Rating -->
            <div class="mb-6">
                <span class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-3 text-center">
                    Note
                </span>
                <div class="flex justify-center gap-2" role="group" aria-label="Note">
                    @for(star of [1, 2, 3, 4, 5]; track star) {
                        <button
                            type="button"
                            (click)="setRating(star)"
                            (mouseenter)="onHoverRating(star)"
                            (mouseleave)="onLeaveRating()"
                            class="focus:outline-none transition-transform hover:scale-110"
                        >
                            <svg
                                class="w-10 h-10 cursor-pointer"
                                [class.text-yellow-400]="star <= (hoveredRating() || selectedRating())"
                                [class.text-gray-300]="star > (hoveredRating() || selectedRating())"
                                fill="currentColor"
                                viewBox="0 0 24 24"
                            >
                                <path d="M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2L9.19 8.63L2 9.24l5.46 4.73L5.82 21z"/>
                            </svg>
                        </button>
                    }
                </div>
                @if(reviewForm.get('rate')?.invalid && reviewForm.get('rate')?.touched) {
                    <p class="text-red-500 text-sm text-center mt-2">Veuillez selectionner une note</p>
                }
            </div>

            <!-- Comment -->
            <div class="mb-6">
                <label for="comment" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">
                    Votre commentaire
                </label>
                <textarea
                    id="comment"
                    formControlName="comment"
                    rows="4"
                    class="w-full px-4 py-3 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-vert focus:border-transparent dark:bg-gray-700 dark:text-white resize-none"
                    placeholder="Partagez votre experience avec notre service..."
                ></textarea>
                @if(reviewForm.get('comment')?.invalid && reviewForm.get('comment')?.touched) {
                    <p class="text-red-500 text-sm mt-1">
                        @if(reviewForm.get('comment')?.errors?.['required']) {
                            Le commentaire est requis
                        } @else if(reviewForm.get('comment')?.errors?.['minlength']) {
                            Le commentaire doit contenir au moins 10 caracteres
                        } @else if(reviewForm.get('comment')?.errors?.['maxlength']) {
                            Le commentaire ne doit pas depasser 500 caracteres
                        }
                    </p>
                }
                <p class="text-gray-500 text-sm mt-1 text-right">
                    {{reviewForm.get('comment')?.value?.length || 0}}/500
                </p>
            </div>

            <!-- Buttons -->
            <div class="flex flex-col sm:flex-row gap-4">
                <button
                    type="submit"
                    [disabled]="reviewForm.invalid || isSubmitting()"
                    class="flex-1 bg-vert text-white py-3 px-6 rounded-lg font-medium hover:bg-green-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed"
                >
                    @if(isSubmitting()) {
                        Envoi en cours...
                    } @else {
                        Envoyer mon avis
                    }
                </button>
                <button
                    type="button"
                    (click)="skipReview()"
                    class="flex-1 bg-gray-200 dark:bg-gray-600 text-gray-700 dark:text-gray-200 py-3 px-6 rounded-lg font-medium hover:bg-gray-300 dark:hover:bg-gray-500 transition-colors"
                >
                    Passer
                </button>
            </div>

        </form>
    </div>

</section>
